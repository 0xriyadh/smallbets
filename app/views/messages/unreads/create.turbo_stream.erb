<%= turbo_stream.remove "unread_separator" %>
<%= turbo_stream.replace dom_id(@message), partial: "messages/message", locals: { message: @message, first_unread_message: @message, current_room: @room } %>
<% if @membership.room.direct? %>
  <%= turbo_stream.replace dom_id(@membership.room, :list), partial: "users/sidebars/rooms/direct", locals: { membership: @membership } %>
<% else %>
  <% [:inbox, :shared_rooms].each do |list_name| %>
    <%= turbo_stream.replace dom_id(@membership.root_membership.room, dom_prefix(list_name, :list_node)), 
                             partial: "users/sidebars/rooms/shared_with_threads", 
                             locals: { list_name:, 
                                       membership: @membership.root_membership,
                                       thread_memberships: @thread_memberships } %>
  <% end %>
<% end %>