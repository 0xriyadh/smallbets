<span class="notification-warning"
    data-controller="notifications" data-notifications-subscriptions-url-value="<%= user_push_subscriptions_path %>" data-notifications-attention-class="btn--pulsing">
  <button class="btn btn--pulsing" data-action="click->notifications#attemptToSubscribe" data-notifications-target="bell">
    <%= image_tag "notification-bell-alert.svg", size: 20, aria: { hidden: "true" } %>
    <span class="for-screen-reader">Enable browser notifications for this <%= room.direct? ? "Ping" : "room" %></span>
  </button>

  <dialog data-notifications-target="notAllowedNotice" class="dialog pad center center-block border-radius border shadow" style="--inline-space: var(--block-space)">
    <div class="flex flex-column txt-align-center">
      <span class="btn btn--faux center txt-x-large">
        <%= image_tag "notification-bell-alert.svg", size: 48, aria: { hidden: "true" } %>
        <span class="for-screen-reader">Notifications alert</span>
      </span>

      <section>
        <h1 class="txt-large margin-none">Notifications aren't allowed</h1>
        <div class="txt-align-start margin-block-start">
          <% if Rails.env.development? %>
            <div class="margin-block">
              <h2 class="txt-medium">Local Development Environment</h2>
              <p>Browser notifications typically require HTTPS, which may not be available in local development.</p>
              <p>To fully test notifications:</p>
              <ul>
                <li>Deploy to a staging environment with HTTPS</li>
                <li>Or set up HTTPS locally using a tool like <a href="https://github.com/FiloSottile/mkcert" target="_blank">mkcert</a></li>
              </ul>
            </div>
          <% end %>
          <%= render partial: "pwa/browser_settings" %>
          <%= render partial: "pwa/system_settings" %>
          <%= render partial: "pwa/install_instructions" %>
        </div>
      </section>

      <form method="dialog" class="flex align-center gap center">
        <button class="btn dialog__close" autofocus="true">
          <span class="for-screen-reader">Close</span>
          <%= image_tag "remove.svg", size: 20, aria: { hidden: "true" } %>
        </button>
      </form>
    </div>
  </dialog>
</span> 